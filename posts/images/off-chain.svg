<svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 880.1746703913267 612.0900572409296" width="880.1746703913267" height="612.0900572409296" filter="invert(93%) hue-rotate(180deg)">
  <!-- svg-source:excalidraw -->
  
  <defs>
    <style class="style-fonts">
      @font-face {
        font-family: "Virgil";
        src: url("https://excalidraw.com/Virgil.woff2");
      }
      @font-face {
        font-family: "Cascadia";
        src: url("https://excalidraw.com/Cascadia.woff2");
      }
    </style>
    
  </defs>
  <rect x="0" y="0" width="880.1746703913267" height="612.0900572409296" fill="#ffffff"></rect><g stroke-linecap="round" transform="translate(239.04390637373217 60.56082138909824) rotate(0 157.92269339215767 49.28084049116978)"><path d="M24.64 0 M24.64 0 C108.68 2.8, 190.71 1.11, 291.2 0 M24.64 0 C120.02 -0.6, 213.83 -0.85, 291.2 0 M291.2 0 C307.33 1.26, 315.93 6.71, 315.85 24.64 M291.2 0 C309.09 -2.28, 317.48 5.97, 315.85 24.64 M315.85 24.64 C315.03 45.44, 315.77 65.14, 315.85 73.92 M315.85 24.64 C316.94 35.17, 316.09 46.3, 315.85 73.92 M315.85 73.92 C317.39 90.26, 306.39 97.75, 291.2 98.56 M315.85 73.92 C316.36 88.33, 309.68 97.29, 291.2 98.56 M291.2 98.56 C192.46 99.04, 92.59 97.62, 24.64 98.56 M291.2 98.56 C226.96 98.76, 164.22 98.52, 24.64 98.56 M24.64 98.56 C9.79 98.78, -1.84 91.86, 0 73.92 M24.64 98.56 C9.35 98.01, -0.41 91.75, 0 73.92 M0 73.92 C-0.49 57.05, 1.86 35.23, 0 24.64 M0 73.92 C-0.12 54.84, -0.59 36.6, 0 24.64 M0 24.64 C-0.59 9.66, 10.08 -1.38, 24.64 0 M0 24.64 C0.25 8.31, 10.42 1.78, 24.64 0" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g><g transform="translate(321.9253199270628 10) rotate(0 76.171875 12)"><text x="0" y="0" font-family="Cascadia, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">off-chain app</text></g><g transform="translate(251.36411649652462 103.12154726783592) rotate(0 102.4749755859375 4.998748191716231)"><text x="0" y="0" font-family="Cascadia, Segoe UI Emoji" font-size="8.331246986193728px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">0xE76fc1CE4d3ffFEA12A5686618844408C327357b</text></g><g transform="translate(249.68408784341648 80.16115567535871) rotate(0 51.5625 9.599999999999909)"><text x="0" y="0" font-family="Cascadia, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">public key:</text></g><g transform="translate(41.36053485801722 238.08384906751644) rotate(0 89.0625 67.20000000000005)"><text x="0" y="0" font-family="Cascadia, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">create a payment:</text><text x="0" y="19.2" font-family="Cascadia, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge"></text><text x="0" y="38.4" font-family="Cascadia, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">    ID</text><text x="0" y="57.599999999999994" font-family="Cascadia, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">    amount</text><text x="0" y="76.8" font-family="Cascadia, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">    receiverAddress</text><text x="0" y="96" font-family="Cascadia, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">    expiration</text><text x="0" y="115.19999999999999" font-family="Cascadia, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">    </text></g><g transform="translate(368.96612221408884 240.32388727166108) rotate(0 229.6875 38.40000000000009)"><text x="0" y="0" font-family="Cascadia, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">hash the payment data:</text><text x="0" y="19.2" font-family="Cascadia, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">    </text><text x="0" y="38.4" font-family="Cascadia, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">    hash(ID, amount, receiverAddress, expiration)</text><text x="0" y="57.599999999999994" font-family="Cascadia, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">    which returns a 32byte hash</text></g><g transform="translate(29.040324735224658 443.04734474669976) rotate(0 417.18749999999994 57.59999999999991)"><text x="0" y="0" font-family="Cascadia, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">hash the data with prefix for signed messages, and then we sign that with our privatekey:</text><text x="0" y="19.2" font-family="Cascadia, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">   </text><text x="0" y="38.4" font-family="Cascadia, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">    sign(hash(prefix+previousDataHash))</text><text x="0" y="57.599999999999994" font-family="Cascadia, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">    which returns: v, r, s</text><text x="0" y="76.8" font-family="Cascadia, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">    we will pass the previusDataHash, with these v, r and s</text><text x="0" y="96" font-family="Cascadia, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">    to the smart contract</text></g><g stroke-linecap="round" transform="translate(21.7602005717564 200.5632091481034) rotate(0 108.64185290098789 99.96170485992957)"><path d="M32 0 M32 0 C75.04 -0.51, 119.34 -1.37, 185.28 0 M32 0 C82.77 -0.57, 133.31 -0.83, 185.28 0 M185.28 0 C207.31 0.65, 218.44 12.27, 217.28 32 M185.28 0 C204.9 0.38, 218.84 8.91, 217.28 32 M217.28 32 C215.21 69.64, 216.99 111.05, 217.28 167.92 M217.28 32 C215.47 62.93, 215.32 95.58, 217.28 167.92 M217.28 167.92 C217.31 190.42, 205.87 200.51, 185.28 199.92 M217.28 167.92 C219.04 190.88, 207.99 200.09, 185.28 199.92 M185.28 199.92 C150.18 199.69, 116.47 200.03, 32 199.92 M185.28 199.92 C148.87 200.68, 114.77 201.74, 32 199.92 M32 199.92 C9.49 198.27, -0.15 187.84, 0 167.92 M32 199.92 C11.15 198.84, -2.24 190.05, 0 167.92 M0 167.92 C-0.43 139.87, -0.59 107.31, 0 32 M0 167.92 C1.7 128.93, 0.53 91.01, 0 32 M0 32 C-0.12 10.58, 11.11 -1.54, 32 0 M0 32 C1.36 8.91, 8.63 0.97, 32 0" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g><g stroke-linecap="round" transform="translate(328.64543453949534 194.96311363774294) rotate(0 261.8044651093394 95.20162367612352)"><path d="M32 0 M32 0 C209.45 1.66, 385.43 0.41, 491.61 0 M32 0 C166.24 -0.91, 301.08 -0.84, 491.61 0 M491.61 0 C513.03 -0.03, 523.24 12.18, 523.61 32 M491.61 0 C512.34 -1.7, 523.23 8.77, 523.61 32 M523.61 32 C523.17 71.35, 524.22 110.18, 523.61 158.4 M523.61 32 C521.87 71.83, 523.06 113.49, 523.61 158.4 M523.61 158.4 C522.46 178.48, 511.16 188.68, 491.61 190.4 M523.61 158.4 C522.64 177.54, 513.44 192.41, 491.61 190.4 M491.61 190.4 C320.1 189.38, 149.95 189.28, 32 190.4 M491.61 190.4 C359.61 189.11, 226.8 189.12, 32 190.4 M32 190.4 C8.91 192.04, -1.17 179.39, 0 158.4 M32 190.4 C10.75 192.64, 1.2 179.35, 0 158.4 M0 158.4 C-1.59 120.78, 0.17 81.85, 0 32 M0 158.4 C0.68 125.63, 0.07 94.86, 0 32 M0 32 C-0.17 8.99, 9.72 0.98, 32 0 M0 32 C-1.11 9.34, 9.17 0.14, 32 0" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g><g stroke-linecap="round" transform="translate(10 425.1270391135472) rotate(0 430.08733519566334 88.48150906369119)"><path d="M32 0 M32 0 C328.12 3.44, 625.41 3.35, 828.17 0 M32 0 C261.25 1.45, 489.81 1.46, 828.17 0 M828.17 0 C847.75 1.63, 859.01 10.32, 860.17 32 M828.17 0 C849.6 2.23, 861.37 10.28, 860.17 32 M860.17 32 C857.85 67.41, 859.61 101.53, 860.17 144.96 M860.17 32 C861.08 60.07, 860.47 90.14, 860.17 144.96 M860.17 144.96 C860 164.62, 848.56 177.94, 828.17 176.96 M860.17 144.96 C859.07 164.96, 848.01 177.1, 828.17 176.96 M828.17 176.96 C551.12 177.91, 274.63 178.09, 32 176.96 M828.17 176.96 C525.66 173.85, 222.73 174.23, 32 176.96 M32 176.96 C9.42 177.09, -0.87 165.44, 0 144.96 M32 176.96 C9.01 178.18, 1.59 164.66, 0 144.96 M0 144.96 C1.24 119.06, 2.83 93.31, 0 32 M0 144.96 C-1.61 102.22, -0.9 58.57, 0 32 M0 32 C1.47 11.99, 12.31 -0.09, 32 0 M0 32 C0.65 12.6, 10.16 1.45, 32 0" stroke="#1e1e1e" stroke-width="1" fill="none"></path></g><g transform="translate(248.52244743665835 118.72197706445604) rotate(0 56.25 9.599999999999909)"><text x="0" y="0" font-family="Cascadia, Segoe UI Emoji" font-size="16px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">private key:</text></g><g transform="translate(250.80410694548868 139.54776852179612) rotate(0 100.360107421875 7.347161577546558)"><text x="0" y="0" font-family="Cascadia, Segoe UI Emoji" font-size="12.24526929591087px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">****************************</text></g></svg>